######################################################################################################################################################
######################################################################################################################################################
######################################################################################################################################################
### Program Name:         

### Version:               1

### This program does:   

### Manual steps needed:   

### Authors:               Arora

### Original Date:       

### Ideas/To do:          
######################################################################################################################################################
######################################################################################################################################################
######################################################################################################################################################

### Settings: ########################################################################################################################################

rm(list=ls()) 

########################################## Libraries: ################################################################################################


library(RMySQL)


### DB connection: ###################################################################################################################################


### Open database connection:

drv <- dbDriver("MySQL")


### set the database to run this script on: 

Database <- "SOLACTIVE"  


con <- dbConnect(drv, user="parora", dbname=Database, host="127.0.0.1", password ="acCvefayMLay", port=3307)  #if not working try 3306, 3307, 3308 or look at:  system("netstat -an")



################################################Enter the Ric Below to check the Id in T_CA_CHANGE##################################################


sql1 <- paste("Select * FROM  T_CA_CHANGE WHERE Ric='4966y.LU'  And Live = 1") 
sql1

DB1 <- as.matrix(dbGetQuery(con, sql1))
head(DB1)

### remove " ":

DB1[, "Id"] <- gsub(" ", "", DB1[, "Id"])

###################################################################################################################################################



# TABLESList <- c("T_BB_TEMP","T_MA","T_CA_CHANGE","T_AF","T_DIV","T_MAPPING","T_SPIN","T_DELIST")
# TABLESList
# 
# for(i in TABLESList)
# {
#   print(paste((i), sep=""))
#   
#   
#   Part1 <- paste(DB1[, "Id"], collapse="', '", sep="") 
#   
#   sql2 <- paste("Select * from ", i," where id in ('", Part1, "')", sep="") 
#   sql2
#   
#   
#   DB2 <- as.matrix(dbGetQuery(con, sql2))
#   head(DB2)
#   
# }

###############################################################TNO:2 FOR T_MA#####################################################################



Part1 <- paste(DB1[, "Id"], collapse="', '", sep="") 

sql2 <- paste("Select * from T_MA where id in ('", Part1, "')", sep="") 
sql2



DB2 <- as.matrix(dbGetQuery(con, sql2))
head(DB2)



#################################################################################################################################################


###############################################################TNO:3 FOR T_BB_TEMP###############################################################


Part1 <- paste(DB1[, "Id"], collapse="', '", sep="") 

sql2 <- paste("Select * from T_BB_TEMP where id in ('", Part1, "') Order By Date", sep="") 
sql2


DB2 <- as.matrix(dbGetQuery(con, sql2))
head(DB2)

write.csv2(DB2, "C:/Users/Arora Peeyush/Desktop/PricesCheck.csv")

#################################################################################################################################################




###############################################################TNO:4 FOR T_AF####################################################################



Part1 <- paste(DB1[, "Id"], collapse="', '", sep="") 

sql2 <- paste("Select * from T_AF where id in ('", Part1, "')", sep="") 
sql2



DB2 <- as.matrix(dbGetQuery(con, sql2))
head(DB2)



#################################################################################################################################################



###############################################################TNO:5 FOR T_DIV###################################################################



Part1 <- paste(DB1[, "Id"], collapse="', '", sep="") 

sql2 <- paste("Select * from T_DIV where id in ('", Part1, "')", sep="") 
sql2



DB2 <- as.matrix(dbGetQuery(con, sql2))
head(DB2)



#################################################################################################################################################




###############################################################TNO:6 FOR T_MAPPING###############################################################



Part1 <- paste(DB1[, "Id"], collapse="', '", sep="") 

sql2 <- paste("Select * from T_MAPPING where id in ('", Part1, "')", sep="") 
sql2



DB2 <- as.matrix(dbGetQuery(con, sql2))
head(DB2)



#################################################################################################################################################





###############################################################TNO:7 FOR T_SPIN##################################################################



Part1 <- paste(DB1[, "Id"], collapse="', '", sep="") 

sql2 <- paste("Select * from T_SPIN where id in ('", Part1, "')", sep="") 
sql2



DB2 <- as.matrix(dbGetQuery(con, sql2))
head(DB2)



#################################################################################################################################################





###############################################################TNO:8 FOR T_DELIST#################################################################



Part1 <- paste(DB1[, "Id"], collapse="', '", sep="") 

sql2 <- paste("Select * from T_DELIST where id in ('", Part1, "')", sep="") 
sql2



DB2 <- as.matrix(dbGetQuery(con, sql2))
head(DB2)



##############################################################################################################################################


